CREATE TABLE IF NOT EXISTS users(
user_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
email VARCHAR(254) UNIQUE NOT NULL,
name VARCHAR(250) NOT NULL
);

CREATE TABLE IF NOT EXISTS categories(
category_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
name VARCHAR(50) UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS events(
event_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
annotation VARCHAR(2000) NOT NULL,
category_id INTEGER REFERENCES categories(category_id),
description VARCHAR(7000) NOT NULL,
event_date TIMESTAMP WITHOUT TIME ZONE NOT NULL,
lat FLOAT NOT NULL,
lon FLOAT NOT NULL,
paid BOOLEAN,
participant_limit INTEGER,
request_moderation BOOLEAN,
title VARCHAR(120) NOT NULL,
created_on TIMESTAMP WITHOUT TIME ZONE NOT NULL,
user_id INTEGER REFERENCES users(user_id),
state VARCHAR(15),
published_on TIMESTAMP WITHOUT TIME ZONE,
confirmed_requests INTEGER,
views INTEGER
);

CREATE TABLE IF NOT EXISTS requests(
request_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
event_id INTEGER REFERENCES events(event_id)  ,
user_id INTEGER REFERENCES users(user_id) ,
created TIMESTAMP WITHOUT TIME ZONE NOT NULL,
status VARCHAR(15) NOT NULL
);